# Техническая документация проекта PassPlease

Данный документ содержит полное техническое описание реализации игры **PassPlease** — симулятора КПП (контрольно-пропускного пункта) общежития.

---

## 1. Архитектура проекта

Проект построен на **компонентно-ориентированном подходе** с использованием **Конечного Автомата (FSM)** для управления состояниями приложения.

*   **Язык**: Haxe.
*   **Паттерны**: Singleton (менеджеры), Composite (сущность студента), Factory (генератор данных).
*   **Управление состоянием**: Глобальный FSM переключает контексты (Меню ↔ Игра ↔ Статистика).

---

## 2. Структура и описание файлов

В проекте 6 файлов, отвечающих за игровую логику.

### Ключевые модули

#### `Game.hx`
**Роль**: Точка входа и глобальный менеджер состояний.
**Технические особенности**:
*   Инициализирует FSM и определяет переходы (`transitions`) между состояниями: `startState`, `gameState`, `statsState`, `finishGameState`.
*   Управляет глобальным объектом статистики `Stats` (загрузка/сохранение).
*   Хранит глобальные константы, например `currentDorm` (текущее общежитие).

#### `GameCycle.hx` (Level Controller)
**Роль**: Контроллер игрового цикла и времени.
**Технические особенности**:
*   **Таймер**: Реализует игровой таймер (`Timer`), который "тикает" каждые 0.2 секунды реального времени.
*   **Генерация волн**: Использует **нормальное распределение** для расчета времени появления студентов, создавая реалистичный "час пик". Максимальное количество студентов появляется в середине рабочего дня.
*   **Обработка ввода**: Метод `processPerson(isLegal)` проверяет решение игрока и начисляет очки или штрафы.

### Модули папки `game/`

#### `game/Person.hx`
**Роль**: Класс представляет сущность студента.
**Технические особенности**:
*   Является контейнером, объединяющим объекты `Pass` (пропуск) и `Backpack` (рюкзак).
*   Служит для передачи данных между логикой (`GameCycle`) и интерфейсом (`UI`).

#### `game/Pass.hx`
**Роль**: Класс представляет сущность пропуска.
**Технические особенности**:
*   Содержит поля: ФИО, факультет, номер общежития, цвет карты, ID.
*   **Метод `isLegal()`**: Проверяет валидность документа по ряду правил (соответствие общежития, пола и цвета карты, корректность хеша ID).
*   При создании использует `Generator` для заполнения данными.

#### `game/Backpack.hx`
**Роль**: Класс представляет сущность инвенторя.
**Технические особенности**:
*   Содержит список предметов (`items`).
*   **Метод `isLegal()`**: Проверяет наличие запрещенных предметов (сверяясь с `Generator.bannedItems`).
*   Включается в игровой процесс только на высоких уровнях (`badge > 10`).

#### `game/Generator.hx`
**Роль**: Класс для генерации процедурного контента.
**Технические особенности**:
*   Содержит статические базы данных (имена, фамилии, факультеты).
*   **Вероятностная ошибка**: Метод `randomMistake()` (0-100) определяет шанс генерации некорректных данных.
*   **Генерация ID**: Создает уникальный ID, на основании студента.
